function time_filter(a,c,b){return a>c&a<b}function num_time_filter(a,c,b){return a>Number(c)&a<Number(b)};function crowdsar(a,c,b){a=a[b+"_stringified"].values;b=null!=a;var d=0,e=0;if(b)for(i=0;i<a.length;i++){var f=JSON.parse(a[i]);time_filter(f.date,c.min_date,c.max_date)&&(e+=1,d+=f[c.field])}"mean"==c.metric&&(d/=e);return{value:Math.round(100*d)/100,is_flag:d>=c.threshold,have:b}};function delinquency(a,c,b){a=a[b+"_stringified"].values;b=null!=a;var d=0;if(b)for(i=0;i<a.length;i++)var e=JSON.parse(a[i]),f=time_filter(e.deadline,c.min_date,c.max_date),d=d+(1==e.is_late&e.form==c.form&f);return{value:d,is_flag:d>=c.threshold,have:b}};function financials(a,c,b){a=a[b+"_stringified"].values;b=null!=a;var d=0;if(b)for(i=0;i<a.length;i++)var e=JSON.parse(a[i]),f=time_filter(e.date,c.min_date,c.max_date),d=d+(e.field==c.field&f&e.value<c.value);return{value:d,is_flag:d>=c.threshold,have:b}};function otc_neighbors(a,c,b){var d=a[b+".otc_paths"].value;a=a[b+".total_paths"].value;b=null!=d;var e=0,f=!1,g=!1;b&&(e=Math.round(100*d/a),f=a>=c.number_of_neighbors[0],g=a<=c.number_of_neighbors[1]);return{value:e,is_flag:f&g&e>=c.threshold,have:b}};function suspensions(a,c,b){a=a["suspensions.date"].value;b=0;var d=null!=a;if(d)for(a=Array.isArray(a)?a:[a],i=0;i<a.length;i++)b+=time_filter(a[i],(new Date(c.min_date)).getTime(),(new Date(c.max_date)).getTime());return{value:b,is_flag:b>c.threshold,have:d}};function symbology(a,c,b){a=a[b+"_stringified"].values;b=null!=a;var d=0;if(b)for(i=0;i<a.length;i++)var e=JSON.parse(a[i]),f=time_filter(e.new_date,c.min_date,c.max_date),d=d+(e.field==c.field&f);return{value:d,is_flag:d>=c.threshold,have:b}};function combine_scores(a,c){var b=0;for(s in a)isNaN(a[s].value)||(b+=a[s].is_flag*(1+.01*a[s].value));return b}var functions={symbology:symbology,delinquency:delinquency,otc_neighbors:otc_neighbors,crowdsar:crowdsar,suspensions:suspensions,financials:financials};function run(){var a={};for(k in params)kscore=functions[k](doc,params[k],k),kscore.have&&(a[k]=kscore);return score?combine_scores(a,params):a}run();